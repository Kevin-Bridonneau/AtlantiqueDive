version: '3.7'

services:
    www:
      image: nginx:alpine
      volumes:
        - ./etc/nginx/conf.d/default.conf.nginx:/etc/nginx/conf.d/default.conf
      ports:
        - 80:80
      depends_on:
        - backend
        - frontend
        
    db:
      image: mariadb
      restart: always
      ports:
        - '3306:3306'
      environment:
        MYSQL_ROOT_PASSWORD: '0000'
        MYSQL_USER: 'daegon'
        MYSQL_PASSWORD: '0000'
        MYSQL_DATABASE: 'atlantiqueDiveSite'
      volumes:
        - ./init/init.sql:/docker-entrypoint-initdb.d/init.sql
        
    backend:
      image: php
      build: ./atlantiqueDiveApi
      ports:
        - '8000:8000'
      depends_on: 
        - db
    
    frontend:
      image: node:lts-alpine
      build: ./frontend
      ports:
        - '8080:8080'
      depends_on: 
        - backend



# for launch the container use the command below
# sudo docker-compose -f docker-compose.yml up
